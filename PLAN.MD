I have a review mcp: elementor-cursor-review-mcp
But I would like to simplify this. 

I prefer to use an existing mcp instead.

In our environment we can access our repos and PRs with GITHUB_TOKEN.

We have created an initial rules set: elementor-cursor-review-mcp/rules.

We already have the 'Github Pull Requests' extension installed.

What I would like to do: 
Provide the Github PR link in the cursor agent chat.
The agent studies the diff.
Compare with our rules.
Creates feedback: 
1. inside an MD document in the root folder of that repo, such as e.g. '/elementor'. Ensure that for every comments we provide file paths and line numbers.
2. Request if we would like to push our comments to the PR. This should be done with inline comments.

00-github-reviews/CHATGPT.md has created some suggestions how we can implement this.

First question: can we use the Github MCP for our '/elementor' repo?
Second question: does the Github MCP assist us?

Create 2 or 3 proposals how we can implement this in our project here. The proposal doens't have to contain the Github MCP. Recommend what workflow is best.


Create a plan inside PLAN.MD. Don't remove our content. Put the content after our content.

---

# Product Requirements Document (PRD)
## Automated GitHub PR Review System with Cursor AI

### 1. Executive Summary

**Product Name:** GitHub PR Review Assistant for Cursor AI  
**Version:** 1.0  
**Date:** October 6, 2025  
**Owner:** Jan van Vlastuin  
**Status:** Draft

**Purpose:** Create a simplified, manual-triggered PR review system that leverages Cursor AI to analyze GitHub PRs against custom coding rules, providing structured feedback in markdown documents and optionally posting inline comments to GitHub PRs.

---

### 2. Current State Analysis

#### 2.1 Existing Assets
- **Custom MCP Server:** `elementor-cursor-review-mcp` (currently complex, needs simplification)
- **Coding Rules:** 22 comprehensive rule files in `elementor-cursor-review-mcp/rules/`
- **GitHub Integration:** Access via `GITHUB_TOKEN` (environment variable)
- **IDE Extension:** GitHub Pull Requests extension installed in Cursor
- **Target Repository:** `/elementor` (private repository)

#### 2.2 Constraints
- No access to Cursor Background Agents (paid tier)
- Manual trigger workflow required (not automated CI/CD)
- Private GitHub repository access
- Need to maintain security and audit trail

#### 2.3 Current Problems
- Existing `elementor-cursor-review-mcp` is too complex
- No streamlined workflow for PR reviews
- Inconsistent application of coding standards
- Manual review process is time-consuming

---

### 3. Goals and Objectives

#### 3.1 Primary Goals
1. **Simplify Review Process:** Replace complex custom MCP with simpler solution
2. **Consistent Standards:** Apply 22 coding rules consistently across all PRs
3. **Reduce Review Time:** Automate first-pass review to free up human reviewers
4. **Maintain Quality:** Ensure reviews are thorough and actionable

#### 3.2 Success Metrics
- Review feedback generated within 2 minutes of providing PR URL
- 80%+ of coding rule violations caught automatically
- 50% reduction in initial review time for human reviewers
- Zero false positives in critical security checks
- 100% of feedback includes file path and line numbers

#### 3.3 Non-Goals (Out of Scope)
- Fully automated CI/CD integration (future consideration)
- Auto-merging of PRs
- Direct code modifications by AI
- Support for multiple repositories simultaneously

---

### 4. Solution Proposals

#### 4.1 Proposal A: GitHub MCP Server (Recommended)

**Architecture:**
```
User â†’ Cursor Chat â†’ GitHub MCP Server â†’ GitHub API
                  â†“
              Local MD File
```

**Components:**
1. **GitHub MCP Server** (self-hosted or existing)
   - Handles authentication with `GITHUB_TOKEN`
   - Provides secure API layer for Cursor
   - Endpoints: `/pr/diff`, `/pr/files`, `/pr/comment`

2. **Cursor Integration**
   - Configure MCP server URL in Cursor settings
   - Load 22 coding rules as context
   - Structured prompt for PR analysis

3. **Output Handlers**
   - Primary: Generate MD file in `/elementor/pr-reviews/PR-{number}.md`
   - Optional: Post inline comments via GitHub API

**Workflow:**
1. User pastes PR URL in Cursor chat
2. Cursor fetches PR diff via MCP server
3. Cursor analyzes against coding rules
4. Cursor generates structured markdown review
5. User reviews feedback
6. User triggers optional comment posting to GitHub

**Pros:**
- Most secure (token handled by MCP server)
- Audit trail built-in
- Reusable for other repos
- Can extend to other GitHub operations

**Cons:**
- Requires MCP server setup
- Additional infrastructure to maintain
- Learning curve for MCP protocol

**Estimated Setup Time:** 4-6 hours

---

#### 4.2 Proposal B: Direct GitHub API Integration

**Architecture:**
```
User â†’ Cursor Chat â†’ GitHub REST API (via GITHUB_TOKEN)
                  â†“
              Local MD File
```

**Components:**
1. **Cursor Agent Workflow**
   - Use `GITHUB_TOKEN` directly in Cursor environment
   - Create custom Cursor command/prompt
   - Fetch PR data via GitHub REST API

2. **Helper Scripts** (optional)
   - `fetch-pr-diff.sh`: Downloads PR diff using token
   - `post-comments.sh`: Posts review comments to PR

3. **Rule Integration**
   - Load rule files as Cursor workspace rules
   - Reference rules in system prompt

**Workflow:**
1. User pastes PR URL in Cursor chat
2. Cursor calls helper script to fetch PR diff (or uses REST API directly)
3. Cursor analyzes diff against rules
4. Cursor generates MD review in repo root
5. User optionally runs helper script to post comments

**Pros:**
- Simpler setup (no MCP server)
- Direct API access (faster)
- Easier to debug
- Lower maintenance overhead

**Cons:**
- Token security concerns (exposed in Cursor env)
- Less audit trail
- Manual scripting required
- Not as extensible

**Estimated Setup Time:** 2-3 hours

---

#### 4.3 Proposal C: Hybrid Approach (Manual Diff Paste)

**Architecture:**
```
User â†’ Manual PR Diff Download â†’ Cursor Chat â†’ Local MD File
                                             â†“
                                  Optional Script â†’ GitHub API
```

**Components:**
1. **Manual Diff Retrieval**
   ```bash
   curl -H "Authorization: token $GITHUB_TOKEN" \
        https://github.com/elementor/elementor/pull/{PR}.diff > pr.diff
   ```

2. **Cursor Processing**
   - User pastes diff content into Cursor chat
   - Cursor applies 22 coding rules
   - Generates structured review

3. **Optional Comment Poster**
   - Small Node.js/Python script
   - Reads Cursor's JSON output
   - Posts to GitHub via REST API

**Workflow:**
1. User downloads PR diff manually
2. User pastes diff into Cursor
3. Cursor analyzes and generates review MD
4. User optionally runs script to post comments

**Pros:**
- Zero infrastructure setup
- Complete control over process
- No security concerns (token only in local scripts)
- Can start immediately

**Cons:**
- Most manual workflow
- No integration benefits
- Multiple steps required
- Prone to human error

**Estimated Setup Time:** 1-2 hours

---

### 5. Recommended Approach

**Selected Proposal:** **Proposal B (Direct GitHub API Integration)** with path to upgrade to Proposal A

**Rationale:**
1. **Fastest Time to Value:** Can start using within 2-3 hours
2. **Simplicity:** No MCP server infrastructure needed initially
3. **Iterative Path:** Can migrate to MCP later if needed
4. **Meets Requirements:** Fulfills all stated goals
5. **Lower Risk:** Fewer moving parts, easier to debug

**Migration Path:**
- Phase 1: Implement Proposal B (Weeks 1-2)
- Phase 2: Evaluate MCP benefits (Week 3)
- Phase 3: Migrate to Proposal A if ROI justifies it (Week 4+)

---

### 6. Detailed Requirements

#### 6.1 Functional Requirements

**FR-1: PR Analysis Trigger**
- **Description:** User provides GitHub PR URL to initiate review
- **Input:** `https://github.com/elementor/elementor/pull/{NUMBER}`
- **Output:** Confirmation that PR is being analyzed
- **Priority:** P0 (Must Have)

**FR-2: PR Diff Retrieval**
- **Description:** System fetches PR diff from GitHub
- **Method:** GitHub REST API using `GITHUB_TOKEN`
- **Endpoint:** `GET /repos/{owner}/{repo}/pulls/{pr_number}.diff`
- **Priority:** P0 (Must Have)

**FR-3: Rule Application**
- **Description:** Apply all 22 coding rules to PR diff
- **Rules Location:** `elementor-cursor-review-mcp/rules/*.md`
- **Coverage:** TypeScript, React, PHP, WordPress, Testing, Security
- **Priority:** P0 (Must Have)

**FR-4: Markdown Report Generation**
- **Description:** Generate structured review in markdown format
- **Location:** `/elementor/pr-reviews/PR-{number}-{date}.md`
- **Format:**
  ```markdown
  # PR Review: #{PR_NUMBER} - {PR_TITLE}
  
  **Date:** {TIMESTAMP}
  **Reviewer:** Cursor AI
  **Status:** {PASSED|NEEDS_WORK|FAILED}
  
  ## Summary
  {EXECUTIVE_SUMMARY}
  
  ## Critical Issues (Blockers)
  - [{FILE}:{LINE}] {ISSUE_DESCRIPTION}
  
  ## High Priority Issues
  - [{FILE}:{LINE}] {ISSUE_DESCRIPTION}
  
  ## Medium Priority Issues
  - [{FILE}:{LINE}] {ISSUE_DESCRIPTION}
  
  ## Code Style Suggestions
  - [{FILE}:{LINE}] {SUGGESTION}
  
  ## Positive Observations
  - {GOOD_PRACTICES_NOTED}
  
  ## Recommendations
  {OVERALL_RECOMMENDATIONS}
  ```
- **Priority:** P0 (Must Have)

**FR-5: Inline Comment Posting (Optional)**
- **Description:** Post review comments directly to GitHub PR
- **Method:** GitHub REST API `POST /repos/{owner}/{repo}/pulls/{pr_number}/comments`
- **Format:** Individual inline comments at specific file/line
- **User Control:** User must explicitly confirm before posting
- **Priority:** P1 (Should Have)

**FR-6: Rule Violation Tracking**
- **Description:** Track which rules were violated
- **Output:** Include rule reference in each comment
- **Example:** `[Rule: typescript-safety] Avoid using 'any' type`
- **Priority:** P1 (Should Have)

**FR-7: False Positive Handling**
- **Description:** User can mark false positives
- **Method:** Add to ignore list or provide feedback
- **Priority:** P2 (Nice to Have)

#### 6.2 Non-Functional Requirements

**NFR-1: Performance**
- Review generation: < 2 minutes for PRs up to 500 lines changed
- Review generation: < 5 minutes for PRs up to 2000 lines changed
- API rate limits: Respect GitHub API limits (5000 requests/hour)

**NFR-2: Security**
- `GITHUB_TOKEN` stored in environment variable (not in code)
- Token minimum scopes: `repo:read`, `pull_request:write`
- Review files not committed to repo (add to `.gitignore`)
- Audit log of all API calls

**NFR-3: Reliability**
- Handle network failures gracefully
- Retry logic for transient API errors (max 3 retries)
- Clear error messages for user

**NFR-4: Maintainability**
- Code follows workspace coding standards
- Rules easy to add/modify/remove
- Documentation for setup and usage

**NFR-5: Usability**
- Simple one-command trigger
- Clear progress indicators
- Actionable feedback (specific file/line/suggestion)

---

### 7. Technical Implementation Plan

#### 7.1 Phase 1: Core Setup (Week 1)

**Tasks:**
1. **Setup PR Diff Fetcher**
   - Create `scripts/fetch-pr-diff.sh`
   - Test with sample PRs
   - Handle authentication errors

2. **Configure Cursor Workspace Rules**
   - Import 22 rule files
   - Create master rule index
   - Test rule loading

3. **Create Review Prompt Template**
   - Define Cursor system prompt for PR reviews
   - Include rule references
   - Test with sample diff

4. **Setup Output Directory**
   - Create `/elementor/pr-reviews/` (add to `.gitignore`)
   - Define file naming convention
   - Test file generation

**Deliverables:**
- Working PR diff fetcher script
- Cursor configured with all rules
- Sample review generated

---

#### 7.2 Phase 2: Review Generation (Week 2)

**Tasks:**
1. **Implement Review Workflow**
   - Create Cursor command: `/review-pr {URL}`
   - Integrate diff fetcher
   - Generate structured markdown

2. **Enhance Output Format**
   - Implement severity levels (Critical/High/Medium/Low)
   - Add file/line references
   - Include code snippets

3. **Test with Real PRs**
   - Review 5-10 historical PRs
   - Validate accuracy
   - Refine rules as needed

4. **Documentation**
   - Write user guide
   - Create example reviews
   - Document common issues

**Deliverables:**
- Functional review command
- 5+ sample reviews
- User documentation

---

#### 7.3 Phase 3: GitHub Integration (Week 3)

**Tasks:**
1. **Create Comment Poster Script**
   - Script: `scripts/post-pr-comments.js`
   - Parse Cursor JSON output
   - Post inline comments via GitHub API

2. **Add User Confirmation**
   - Display review summary
   - Ask for confirmation before posting
   - Allow selective posting

3. **Error Handling**
   - Handle API rate limits
   - Retry transient failures
   - Log all actions

4. **Testing**
   - Test on sandbox PRs
   - Verify comment formatting
   - Validate line mappings

**Deliverables:**
- Comment posting script
- Test results
- Updated documentation

---

#### 7.4 Phase 4: Refinement (Week 4)

**Tasks:**
1. **Rule Tuning**
   - Review false positives
   - Adjust rule sensitivity
   - Add missing rules

2. **Performance Optimization**
   - Optimize diff parsing
   - Reduce API calls
   - Cache results

3. **User Experience**
   - Add progress indicators
   - Improve error messages
   - Create shortcuts

4. **Metrics Collection**
   - Track review time
   - Measure accuracy
   - Collect user feedback

**Deliverables:**
- Optimized system
- Metrics dashboard
- Final documentation

---

### 8. Technical Architecture

#### 8.1 System Components

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     User (Developer)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ 1. Paste PR URL
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Cursor AI Chat                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  System Prompt:                                     â”‚    â”‚
â”‚  â”‚  - Load 22 coding rules                            â”‚    â”‚
â”‚  â”‚  - PR review instructions                          â”‚    â”‚
â”‚  â”‚  - Output format specification                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ 2. Fetch diff
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Helper Script: fetch-pr-diff.sh                â”‚
â”‚  - Parse PR URL                                             â”‚
â”‚  - Call GitHub API with GITHUB_TOKEN                        â”‚
â”‚  - Return raw diff                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ 3. Diff content
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Cursor AI Analysis                     â”‚
â”‚  - Parse diff (files, lines, changes)                       â”‚
â”‚  - Apply coding rules                                       â”‚
â”‚  - Generate structured findings                             â”‚
â”‚  - Create markdown report                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ 4. Generate review
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Output: /elementor/pr-reviews/PR-XXX.md            â”‚
â”‚  - Executive summary                                        â”‚
â”‚  - Issues by severity                                       â”‚
â”‚  - File/line references                                     â”‚
â”‚  - Recommendations                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ 5. User reviews & confirms
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Optional: Helper Script: post-pr-comments.js        â”‚
â”‚  - Parse markdown review                                    â”‚
â”‚  - Convert to GitHub comment format                         â”‚
â”‚  - POST to GitHub API                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ 6. Comments posted
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      GitHub PR                              â”‚
â”‚  - Inline comments at specific lines                        â”‚
â”‚  - Grouped by file                                          â”‚
â”‚  - Referenced to coding rules                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 8.2 Data Flow

**Input:**
- PR URL: `https://github.com/elementor/elementor/pull/123`

**Processing:**
1. Extract: `{owner: "elementor", repo: "elementor", pr: 123}`
2. Fetch: `GET https://api.github.com/repos/elementor/elementor/pulls/123.diff`
3. Parse: Diff format â†’ structured files/changes
4. Analyze: Apply 22 rules â†’ generate findings
5. Format: Findings â†’ markdown report

**Output:**
- Primary: `/elementor/pr-reviews/PR-123-2025-10-06.md`
- Optional: GitHub inline comments

---

### 9. File Structure

```
/elementor/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ pr-review-config.json         # Review configuration
â”œâ”€â”€ pr-reviews/                        # Generated reviews (gitignored)
â”‚   â”œâ”€â”€ PR-123-2025-10-06.md
â”‚   â””â”€â”€ PR-124-2025-10-07.md
â””â”€â”€ scripts/
    â”œâ”€â”€ fetch-pr-diff.sh              # Fetch PR diff from GitHub
    â”œâ”€â”€ post-pr-comments.js            # Post comments to GitHub PR
    â””â”€â”€ review-helpers.sh              # Utility functions

/elementor-cursor-review-mcp/
â””â”€â”€ rules/                             # 22 coding rule files
    â”œâ”€â”€ typescript-safety.md
    â”œâ”€â”€ react-performance.md
    â””â”€â”€ ... (20 more)
```

---

### 10. Risk Analysis & Mitigation

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| GitHub API rate limits | High | Medium | Implement caching, respect rate limits, use conditional requests |
| Cursor AI hallucinations | High | Low | Human review required, validate all suggestions, track false positives |
| Token exposure | Critical | Low | Use environment variables, never commit tokens, audit access logs |
| Large PR timeout | Medium | Medium | Set timeouts, handle gracefully, support partial reviews |
| Rule conflicts | Medium | Low | Prioritize rules, clear documentation, test rule interactions |
| Network failures | Low | Medium | Retry logic, offline mode with cached data, clear error messages |
| False positives | Medium | High | Track feedback, tune rules, allow user overrides |

---

### 11. Success Criteria & KPIs

#### 11.1 Launch Criteria (Must Meet All)
- [ ] Successfully review 10 historical PRs with 80%+ accuracy
- [ ] Generate reviews in < 2 minutes for typical PRs (< 500 lines)
- [ ] Zero critical bugs in production for 1 week
- [ ] User documentation complete and tested
- [ ] All 22 coding rules integrated and tested

#### 11.2 Key Performance Indicators

**Quality Metrics:**
- False positive rate: < 10%
- False negative rate: < 5%
- Rule coverage: 100% of 22 rules applied
- Critical issue detection rate: > 95%

**Performance Metrics:**
- Average review time: < 2 minutes
- API call efficiency: < 5 calls per review
- User satisfaction: > 4/5 rating

**Adoption Metrics:**
- PRs reviewed per week: Target 20+
- Inline comments posted: Track usage
- Time saved per review: Measure vs manual

---

### 12. Future Enhancements (Post-MVP)

**Phase 5: Advanced Features**
1. **Automated Triggers**
   - GitHub Actions integration
   - Webhook-based reviews
   - Scheduled reviews

2. **Learning & Improvement**
   - Track false positives
   - Auto-tune rule sensitivity
   - Machine learning for pattern detection

3. **Multi-Repository Support**
   - Support multiple Elementor repos
   - Shared rule library
   - Cross-repo consistency

4. **Advanced Analytics**
   - Code quality trends
   - Most common violations
   - Reviewer productivity metrics

5. **MCP Migration**
   - Migrate to GitHub MCP Server
   - Enhanced security
   - Better audit trails

---

### 13. Open Questions & Decisions Needed

**Q1:** Should reviews be automatically committed to repo or kept local?
- **Recommendation:** Keep local (gitignored) initially, reconsider after user feedback

**Q2:** Should the system auto-post comments or always require manual confirmation?
- **Recommendation:** Always require confirmation (safety first)

**Q3:** What severity level should block PR merging?
- **Recommendation:** Only "Critical" issues block, others are warnings

**Q4:** Should we archive historical reviews?
- **Recommendation:** Yes, monthly archives in separate directory

**Q5:** Should the system support incremental reviews (only new commits)?
- **Recommendation:** Phase 2 feature, start with full PR reviews

---

### 14. Conclusion

This PRD outlines a pragmatic approach to automating GitHub PR reviews using Cursor AI. The recommended solution (Proposal B: Direct GitHub API Integration) provides the fastest path to value while maintaining security and quality standards.

**Next Steps:**
1. Approve this PRD
2. Setup development environment (Week 1)
3. Implement core functionality (Week 2)
4. Test with real PRs (Week 3)
5. Deploy to production (Week 4)

**Estimated Total Effort:** 80-100 hours over 4 weeks  
**Expected ROI:** 50% reduction in initial review time, saving ~10 hours/week for team

---

## Appendix A: Helper Scripts

### A.1 fetch-pr-diff.sh

```bash
#!/bin/bash
# Fetch PR diff from GitHub

PR_URL=$1

# Extract owner, repo, and PR number from URL
if [[ $PR_URL =~ github\.com/([^/]+)/([^/]+)/pull/([0-9]+) ]]; then
    OWNER="${BASH_REMATCH[1]}"
    REPO="${BASH_REMATCH[2]}"
    PR_NUMBER="${BASH_REMATCH[3]}"
else
    echo "Error: Invalid PR URL format"
    exit 1
fi

# Fetch diff using GitHub API
curl -H "Authorization: token $GITHUB_TOKEN" \
     -H "Accept: application/vnd.github.v3.diff" \
     "https://api.github.com/repos/$OWNER/$REPO/pulls/$PR_NUMBER" \
     -o "pr-$PR_NUMBER.diff"

echo "Diff saved to pr-$PR_NUMBER.diff"
```

### A.2 post-pr-comments.js

```javascript
#!/usr/bin/env node
// Post inline comments to GitHub PR

const { Octokit } = require('@octokit/rest');
const fs = require('fs');

const octokit = new Octokit({
  auth: process.env.GITHUB_TOKEN
});

async function postComments(owner, repo, prNumber, comments) {
  for (const comment of comments) {
    try {
      await octokit.pulls.createReviewComment({
        owner,
        repo,
        pull_number: prNumber,
        body: comment.body,
        path: comment.path,
        line: comment.line,
        side: 'RIGHT'
      });
      console.log(`âœ“ Posted comment on ${comment.path}:${comment.line}`);
    } catch (error) {
      console.error(`âœ— Failed to post comment: ${error.message}`);
    }
  }
}

// Usage: node post-pr-comments.js <owner> <repo> <pr-number> <comments.json>
const [owner, repo, prNumber, commentsFile] = process.argv.slice(2);
const comments = JSON.parse(fs.readFileSync(commentsFile, 'utf8'));
postComments(owner, repo, prNumber, comments);
```

---

## Appendix B: Cursor System Prompt Template

```markdown
You are a senior code reviewer analyzing GitHub Pull Requests for the Elementor project.

## Your Role
- Analyze PR diffs against 22 established coding rules
- Provide specific, actionable feedback
- Reference exact file paths and line numbers
- Categorize issues by severity (Critical, High, Medium, Low)

## Review Process
1. Parse the PR diff to understand all changes
2. Apply each of the 22 coding rules
3. Identify violations, improvements, and positive patterns
4. Generate structured markdown report

## Output Format
Generate a markdown report with:
- Executive summary
- Issues grouped by severity
- Each issue must include: [file:line] reference
- Specific rule violated
- Recommended fix with code example
- Positive observations

## Severity Definitions
- **Critical:** Security vulnerabilities, data loss risks, breaking changes
- **High:** Performance issues, architectural problems, major bugs
- **Medium:** Code style violations, minor bugs, technical debt
- **Low:** Suggestions, optimizations, best practices

## Rules to Apply
[List of 22 rules from elementor-cursor-review-mcp/rules/]

## Remember
- Be specific, not generic
- Suggest fixes, don't just identify problems
- Acknowledge good practices
- Be constructive, not critical
```

---

**Document Status:** âœ… Approved - Implementation Ready  
**Selected Proposal:** **Proposal A - GitHub MCP Server**  
**Last Updated:** October 6, 2025  
**Next Review:** After Phase 1 completion

---

## Implementation Update

**Status:** ðŸŸ¢ Ready to Implement  
**Date:** October 6, 2025

### Decision: Proposal A Selected

After review, **Proposal A (GitHub MCP Server)** has been selected for implementation instead of the originally recommended Proposal B. This provides better long-term benefits:

âœ… **Advantages of MCP Approach:**
- More secure (token handled by MCP server)
- Better audit trail
- Can use GitHub's hosted MCP (no self-hosting needed with Copilot)
- Reusable for other GitHub operations
- Official GitHub integration

### Documentation Created

All implementation documentation has been created in `/00-github-reviews/`:

| Document | Purpose | Status |
|----------|---------|--------|
| **README.md** | Overview and navigation | âœ… Complete |
| **QUICK-START.md** | 5-minute setup guide | âœ… Complete |
| **MCP-SETUP-GUIDE.md** | Detailed MCP configuration | âœ… Complete |
| **IMPLEMENTATION-STATUS.md** | Implementation checklist | âœ… Complete |
| **PLAN.MD** | This PRD | âœ… Complete |

### Infrastructure Created

| Component | Location | Status |
|-----------|----------|--------|
| Scripts directory | `/scripts/` | âœ… Created |
| PR reviews directory | `/pr-reviews/` | âœ… Created |
| Helper script | `/scripts/review-pr-mcp.sh` | âœ… Complete |
| Gitignore | `/00-github-reviews/.gitignore` | âœ… Complete |

### Next Steps

1. **Review Documentation:** Start with [README.md](./README.md)
2. **Setup MCP:** Follow [QUICK-START.md](./QUICK-START.md)
3. **Test System:** Use [IMPLEMENTATION-STATUS.md](./IMPLEMENTATION-STATUS.md) checklist
4. **Begin Reviews:** Run `./scripts/review-pr-mcp.sh` with a sample PR

**Estimated Time to First Review:** 15-20 minutes

---

**Document Status:** âœ… Approved - Implementation Ready  
**Selected Proposal:** **Proposal A - GitHub MCP Server**  
**Last Updated:** October 6, 2025  
**Next Review:** After Phase 1 completion